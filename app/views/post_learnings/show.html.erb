<div class="first-show-view">
  <%= render 'shared/header' %>
  <div class="result-genre-name-show">
    <p>学習投稿詳細</p>
  </div>
  <div class="top-contents">
    <aside class="sidebar_left">
      <%= render 'shared/sidebar_left' %>
    </aside>
    <article class="home-article">
      <div class="show-article">
        <div class="show-top">
          <div class="show-main-left">
            <div class="article-time">
              <%= time_ago_in_words(@post_learning.created_at) %>前
            </div>
            <div class="show-post-image">
              <p><%= image_tag @post_learning.post_image.variant(resize_to_limit: [300,260]) if @post_learning.post_image.attached? %></p>
            </div>
          </div>
  
          <div class="show-main-right">
            
            <div class="show-inner-middle">
              <div class="show-post-name">
                <p>学習名</p>
              </div>
              <div class="show-post-content">
                <p>頑張ったこと</p>
              </div>
              <div class="show-post-real">
                <p>学びの本音</p>
              </div>
              <div class="show-post-genre">
                <p>ジャンル</p>
              </div>
            </div>
           
            <div class="show-inner-right">
              <div class="show-post-name-inner">
                <p><%= @post_learning.learning_name %></p>
              </div>
              <div class="show-post-content-inner">
                <p><%= @post_learning.learning_content %></p>
              </div>
              <div class="show-post-real-inner">
                <p><%= @post_learning.learning_real %></p>
              </div>
              <div class="show-post-genre-inner">
                <p><%= @post_learning.genre.name %></p>
              </div>
            </div>
          </div>
        </div>
        <div class="show-favorite-edit">
          <div class="show-post-favorite">
            <% if @post_learning.favorited_by?(current_user) %>
              <p>
                <%= link_to post_learning_favorites_path(@post_learning), method: :delete do %>
                  ♥<%= @post_learning.favorites.count %> いいね
                <% end %>
              </p>
            <% else %>
              <p>
                <%= link_to post_learning_favorites_path(@post_learning), method: :post do %>
                  ♡<%= @post_learning.favorites.count %> いいね
                <% end %>
              </p>
            <% end %>
          </div>
          <div class="show-edit-destroy">
            <% if user_signed_in? && current_user.id == @post_learning.user_id %>
              <%= link_to "編集", edit_post_learning_path(@post_learning) %>
              <%= link_to "削除", post_learning_path(@post_learning.id), method: :delete, "data-confirm" => "本当に削除しますか？" %>
            <% elsif current_user.admin? %>
              <%= link_to "削除", post_learning_path(@post_learning.id), method: :delete, "data-confirm" => "本当に削除しますか？" %>
            <% end %>
          </div>
        </div>
      </div>
      <% if @error_comment.present? %>
        <div class="error-message">
          <% if @error_comment.errors.any? %>
            <%= @error_comment.errors.count %>件のエラーが発生しました
              <ul>
                <% @error_comment.errors.full_messages.each do |message| %>
                  <li><%= message %></li>
                <% end %>
              </ul>
          <% end %>
        </div>
      <% end %>
        <%= form_with model: [@post_learning, @post_comment] do |f| %>
          <div class="show-post-comment">
            <div class="post-comment-inner">
              <%= f.text_area :comment, rows: '5', placeholder: "コメントをここに" , class: "show-text-area" %>
            </div>
            <div class="show-form-btn">
              <%= f.submit "コメント投稿"%>
            </div>
          </div>
        <% end %>
       <% @post_learning.post_comments.each do |post_comment| %>
        <div class="show-comment-top">
          <div class="show-comment">
            <div class="article-time show-comment-time">
              <%= time_ago_in_words(post_comment.created_at) %>前
            </div>
            <div class="show-comment-left">
              <div class="show-comment-user">
                <p><%= post_comment.user.name %></p>
              </div>
              <div class="show-user-image">
                <p><%= image_tag post_comment.user.get_profile_image(100,100) %></p>
              </div>
            </div>
            <div class="show-comment-inner">
              <p><%= post_comment.comment %></p>
            </div>
            <div class="show-comment-destroy">
              <% if post_comment.user == current_user %>
                <%= link_to "削除", post_learning_post_comment_path(post_comment.post_learning, post_comment), method: :delete, class: "show-destroy" %>
              <% elsif current_user.admin? %>
                <%= link_to "削除", post_learning_post_comment_path(post_comment.post_learning, post_comment), method: :delete, class: "show-destroy" %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </article>
    <aside class="sidebar_right">
      <%= render 'shared/sidebar_right' %>
    </aside>
  </div>
</div>


